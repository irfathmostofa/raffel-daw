# name: ğŸš€ Deploy website on push

# on:
#   push:
#     branches:
#       - main

# jobs:
#   web-deploy:
#     name: ğŸ‰ Deploy
#     runs-on: ubuntu-latest

#     steps:
#       - name: ğŸšš Get latest code
#         uses: actions/checkout@v4

#       - name: ğŸ§° Setup Node.js
#         uses: actions/setup-node@v3
#         with:
#           node-version: "18"

#       - name: ğŸ”¨ Build Project
#         run: |
#           npm install
#           npm run build

#       - name: ğŸ“‚ Sync files via FTP
#         uses: SamKirkland/FTP-Deploy-Action@v4.3.5
#         with:
#           server: ${{ secrets.ftp_server }}
#           username: ${{ secrets.ftp_user }}
#           password: ${{ secrets.ftp_password }}
#           dangerous-clean-slate: true
#           server-dir: /home/mpairproject/gitlabserver.mpairproject.xyz/
#           local-dir: ./dist/
#           protocol: ftp
#           port: 21
#           passive: true
name: ğŸš€ Deploy React App via SSH

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4

      - name: ğŸŸ¢ Setup Node.js (for React app)
        uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: ğŸ“¦ Install Dependencies & Build React App
        run: |
          npm install
          npm run build

      - name: ğŸ” Setup SSH Agent
        uses: webfactory/ssh-agent@v0.5.3
        with:
          ssh-private-key: ${{ secrets.SSH_PRIVATE_KEY }}

      - name: ğŸ“‚ Deploy with rsync (React Build)
        run: |
          rsync -avz --delete ./build/ ${{ secrets.SSH_USERNAME }}@${{ secrets.SSH_HOST }}:${{ secrets.REMOTE_PATH }}
